function makeGUI(gui)
% Syntax:
%
% makeGUI(gui)
%
% Description:
%
% Part of DAG.
% 
% Written by Kenneth Sæterhagen Paulsen

% Copyright (c) 2021, Kenneth Sæterhagen Paulsen

    parent = gui.parent;

    % Create the main window
    %--------------------------------------------------------------
    if isa(parent,'nb_GUI')
        name = [parent.guiName ': x12 Census Filter'];
    else
        name = 'x12 Census Filter';
    end
    
    % Create window
    %--------------------------------------------------------------
    currentMonitor    = nb_getCurrentMonitor();
    defaultBackground = get(0,'defaultUicontrolBackgroundColor');
    f = figure(   'visible',        'off',...
                  'units',          'characters',...
                  'position',       [65,   15,  120,   30],...
                  'Color',          defaultBackground,...
                  'name',           name,...
                  'numberTitle',    'off',...
                  'menuBar',        'None',...
                  'toolBar',        'None',...
                  'resize',         'off',...
                  'windowStyle',    'modal');
    nb_moveFigureToMonitor(f,currentMonitor);
    
    % Create panels
    %--------------------------------------------------------------
    pSpace  = 0.02;
    pWidth1 = 0.65;
    pWidth2 = 1 - pWidth1 - pSpace*3;
    uip1 = uipanel(...
        'units',              'normalized',...
        'position',           [pSpace, pSpace, pWidth1, 1 - pSpace*2],...
        'parent',             f,...
        'title',              'Options');
    
    
    uip2 = uipanel(...
        'units',              'normalized',...
        'position',           [pSpace*2 + pWidth1, pSpace, pWidth2, 1 - pSpace*2],...
        'parent',             f,...
        'title',              'Select Variables');
    
    % Variables selection list
    %--------------------------------------------------------------
    num = size(gui.data.variables,2); 
    gui.list1 = uicontrol(...
      'units',              'normalized',...
      'position',           [0.02, 0.1, 0.96, 0.88],...
      'parent',             uip2,...
      'background',         [1 1 1],...
      'style',              'listbox',...
      'string',             gui.data.variables,...
      'max',                num,...
      'value',              1:num);
  
    gui.rball = uicontrol(...
              'units',          'normalized',...
              'position',       [0.02, 0.02, 0.5, 0.06],...
              'parent',         uip2,...
              'style',          'radiobutton',...
              'Interruptible',  'off',...
              'string',         'All',...
              'value',          0,...
              'callback',       @gui.allCallback);
    
    % Locations
    %--------------------------------------------------------------
    startPopX = 0.45;
    widthPop  = 0.525;
    heightPop = 0.06;
    startTX   = 0.06;
    widthT    = widthPop - startTX*2;
    heightT   = 0.0533;
%     widthB    = 1 - startPopX - widthPop - startTX*2;
%     startB    = startPopX + widthPop + startTX;
    kk        = 11; 
    spaceYPop = (1 - heightPop*kk)/(kk + 1);
    extra     = -(heightPop - heightT);
    
    % Output
    %--------------------------------------------------------------
    uicontrol(...
              'units',                  'normalized',...
              'position',               [startTX, heightPop*(kk-1) + spaceYPop*kk + extra, widthT, heightT],...
              'parent',                 uip1,...
              'style',                  'text',...
              'horizontalAlignment',    'left',...
              'string',                 'Output');


    strings = {'Seasonally Adjusted Series',...
               'Seasonally Component',...
               'Trend Cycle Series',...
               'Irregular Component',...
               'Missing Observation Replacement'};
    value = 1;
    
    gui.pop1 = uicontrol(...
              'units',          'normalized',...
              'position',       [startPopX, heightPop*(kk-1) + spaceYPop*kk, widthPop, heightPop],...
              'parent',         uip1,...
              'background',     [1 1 1],...
              'style',          'popupmenu',...
              'Interruptible',  'off',...
              'string',         strings,...
              'value',          value);
    
    % Mode
    %--------------------------------------------------------------
    kk = kk - 1;
    gui.pop2 = uicontrol(...
              'units',                  'normalized',...
              'position',               [startTX, heightPop*(kk-1) + spaceYPop*kk + extra, widthT, heightT],...
              'parent',                 uip1,...
              'style',                  'text',...
              'horizontalAlignment',    'left',...
              'string',                 'Mode');


    strings = {'Automatic',...
               'Multiplicative',...
               'Additive',...
               'Log Additive',...
               'Pseudo Additive'};
    value = 1;
    
    gui.pop2 = uicontrol(...
              'units',          'normalized',...
              'position',       [startPopX, heightPop*(kk-1) + spaceYPop*kk, widthPop, heightPop],...
              'parent',         uip1,...
              'background',     [1 1 1],...
              'style',          'popupmenu',...
              'Interruptible',  'off',...
              'string',         strings,...
              'value',          value);
          
    % Dummy type
    %--------------------------------------------------------------
    kk = kk - 1;
    uicontrol(...
              'units',                  'normalized',...
              'position',               [startTX, heightPop*(kk-1) + spaceYPop*kk + extra, widthT, heightT],...
              'parent',                 uip1,...
              'style',                  'text',...
              'horizontalAlignment',    'left',...
              'string',                 'Dummy Type');


    strings = {'Holiday',...
               'Trading Days'};
    value = 1;
    
    gui.pop3 = uicontrol(...
              'units',          'normalized',...
              'position',       [startPopX, heightPop*(kk-1) + spaceYPop*kk, widthPop, heightPop],...
              'parent',         uip1,...
              'background',     [1 1 1],...
              'style',          'popupmenu',...
              'Interruptible',  'off',...
              'string',         strings,...
              'value',          value);
          
    % Correct for Trading Days
    %--------------------------------------------------------------
    kk = kk - 1;
    uicontrol(...
              'units',                  'normalized',...
              'position',               [startTX, heightPop*(kk-1) + spaceYPop*kk + extra, widthT, heightT],...
              'parent',                 uip1,...
              'style',                  'text',...
              'horizontalAlignment',    'left',...
              'string',                 'Correct for Trading Days');

    gui.rb1 = uicontrol(...
              'units',          'normalized',...
              'position',       [startPopX, heightPop*(kk-1) + spaceYPop*kk, widthPop, heightPop],...
              'parent',         uip1,...
              'style',          'radiobutton',...
              'Interruptible',  'off',...
              'string',         '',...
              'value',          0);
          
    % Max Iterations
    %--------------------------------------------------------------
    kk = kk - 1;
    uicontrol(...
              'units',                  'normalized',...
              'position',               [startTX, heightPop*(kk-1) + spaceYPop*kk + extra, widthT, heightT],...
              'parent',                 uip1,...
              'style',                  'text',...
              'horizontalAlignment',    'left',...
              'string',                 'Max Iterations');

    gui.edit1 = uicontrol(...
              'units',              'normalized',...
              'position',           [startPopX, heightPop*(kk-1) + spaceYPop*kk, widthPop, heightPop],...
              'parent',             uip1,...
              'background',         [1 1 1],...
              'style',              'edit',...
              'horizontalAlignment','right',...
              'Interruptible',      'off',...
              'string',             '1500');
          
    % Missing
    %--------------------------------------------------------------
    kk = kk - 1;
    uicontrol(...
              'units',                  'normalized',...
              'position',               [startTX, heightPop*(kk-1) + spaceYPop*kk + extra, widthT, heightT],...
              'parent',                 uip1,...
              'style',                  'text',...
              'horizontalAlignment',    'left',...
              'string',                 'Missing Observations');

    temp  = double(gui.data);
    isNaN = isnan(temp(:));
    if any(isNaN)
        value = 1;
    else
        value = 0;
    end
          
    gui.rb2 = uicontrol(...
              'units',          'normalized',...
              'position',       [startPopX, heightPop*(kk-1) + spaceYPop*kk, widthPop, heightPop],...
              'parent',         uip1,...
              'style',          'radiobutton',...
              'Interruptible',  'off',...
              'string',         '',...
              'value',          value);
          
    % Logarithmise
    %--------------------------------------------------------------
    kk = kk - 1;
    uicontrol(...
              'units',                  'normalized',...
              'position',               [startTX, heightPop*(kk-1) + spaceYPop*kk + extra, widthT, heightT],...
              'parent',                 uip1,...
              'style',                  'text',...
              'horizontalAlignment',    'left',...
              'string',                 'Logarithmise');

    gui.rb3 = uicontrol(...
              'units',          'normalized',...
              'position',       [startPopX, heightPop*(kk-1) + spaceYPop*kk, widthPop, heightPop],...
              'parent',         uip1,...
              'style',          'radiobutton',...
              'Interruptible',  'off',...
              'string',         '',...
              'value',          0);
          
    % Postfix
    %--------------------------------------------------------------
    kk = kk - 1;
    uicontrol(...
              'units',                  'normalized',...
              'position',               [startTX, heightPop*(kk-1) + spaceYPop*kk + extra, widthT, heightT],...
              'parent',                 uip1,...
              'style',                  'text',...
              'horizontalAlignment',    'left',...
              'string',                 'Postfix');

    gui.edit2 = uicontrol(...
              'units',              'normalized',...
              'position',           [startPopX, heightPop*(kk-1) + spaceYPop*kk, widthPop, heightPop],...
              'parent',             uip1,...
              'background',         [1 1 1],...
              'style',              'edit',...
              'horizontalAlignment','left',...
              'Interruptible',      'off',...
              'string',             '_adj');      
          
    % Start date
    %--------------------------------------------------------------
    kk = kk - 1;
    uicontrol(...
              'units',                  'normalized',...
              'position',               [startTX, heightPop*(kk-1) + spaceYPop*kk + extra, widthT, heightT],...
              'parent',                 uip1,...
              'style',                  'text',...
              'horizontalAlignment',    'left',...
              'string',                 'Start date');

    gui.edit3 = uicontrol(...
              'units',              'normalized',...
              'position',           [startPopX, heightPop*(kk-1) + spaceYPop*kk, widthPop, heightPop],...
              'parent',             uip1,...
              'background',         [1 1 1],...
              'style',              'edit',...
              'horizontalAlignment','left',...
              'Interruptible',      'off',...
              'string',             ''); 

    % Start date
    %--------------------------------------------------------------
    kk = kk - 1;
    uicontrol(...
              'units',                  'normalized',...
              'position',               [startTX, heightPop*(kk-1) + spaceYPop*kk + extra, widthT, heightT],...
              'parent',                 uip1,...
              'style',                  'text',...
              'horizontalAlignment',    'left',...
              'string',                 'End date');

    gui.edit4 = uicontrol(...
              'units',              'normalized',...
              'position',           [startPopX, heightPop*(kk-1) + spaceYPop*kk, widthPop, heightPop],...
              'parent',             uip1,...
              'background',         [1 1 1],...
              'style',              'edit',...
              'horizontalAlignment','left',...
              'Interruptible',      'off',...
              'string',             ''); 

    % Calaculate button
    %--------------------------------------------------------------
    buttonHeight = 0.0667;
    buttonWidth  = 0.3;
    buttonXLoc   = 0.5 - buttonWidth/2;
    buttonYLoc   = (heightPop*(kk-1) + spaceYPop*kk)/2 - buttonHeight/2;
    
    uicontrol(...
              'units',              'normalized',...
              'position',           [buttonXLoc, buttonYLoc, buttonWidth, buttonHeight],...
              'parent',             uip1,...
              'style',              'pushbutton',...
              'Interruptible',      'off',...
              'busyAction',         'cancel',...
              'string',             'Adjust Series',...
              'callback',           @gui.adjustCallback);
          
    % Make it visible
    set(f,'visible','on')
          
end
