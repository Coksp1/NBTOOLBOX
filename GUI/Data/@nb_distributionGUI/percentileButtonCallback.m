function percentileButtonCallback(gui)
% Syntax:
%
% percentileButtonCallback(gui)
%
% Description:
%
% Part of DAG.
% 
% Written by Henrik Halvorsen Hortemo

% Copyright (c) 2024, Kenneth SÃ¦terhagen Paulsen

    % Figure
    currentMonitor    = nb_getCurrentMonitor();
    defaultBackground = get(0, 'defaultUicontrolBackgroundColor');
    figureHandle = figure(...
        'visible',        'off',...
        'units',          'characters',...
        'position',       [40   15  50   10],...
        'Color',          defaultBackground,...
        'name',           'Select percentiles',...
        'numberTitle',    'off',...
        'menuBar',        'None',...
        'toolBar',        'None',...
        'resize',         'off');               
    nb_moveFigureToMonitor(figureHandle, currentMonitor, 'center');
    
    panel = uipanel(figureHandle, ...
        'Position', [.025 .05 .95 .9], ...
        'BorderType', 'none');

    percentilesBox = uicontrol(...
        'parent',             panel,...
        'background',         [1 1 1],...
        'style',              'edit',...
        'horizontalAlignment','center',...
        'Interruptible',      'off', ...
        'units', 'normalized', ...
        'String', '[10,20,30,40,50,60,70,80,90]', ...
        'Position', [0 .5 1 .5]);
    
    uicontrol(...
        'parent',             panel,...
        'units',              'normalized', ...
        'Position',           [0 0 1 .4],...
        'style',              'pushbutton',...
        'string',             'Get percentiles',...
        'callback',           {@showPercentiles});
    
    set(figureHandle, 'Visible', 'on');
    
    function showPercentiles(~, ~)
        percentiles = nb_str2double(get(percentilesBox, 'String'));
        data = gui.currentDistribution.percentile(percentiles);
        
        close(figureHandle);
        
        % Figure
        figureHandle2 = figure(...
            'visible',        'off',...
            'units',          'characters',...
            'Position', [40 15 150 20], ...
            'Color',          defaultBackground,...
            'name',           'Percentiles',...
            'numberTitle',    'off',...
            'menuBar',        'None');               
        nb_moveFigureToMonitor(figureHandle2, currentMonitor, 'center');
        
        nb_uitable(figureHandle2, ...
            'ColumnName', percentiles, ...
            'Data', data, ...
            'Units', 'normalized', ...
            'Position', [0 0 1 1]);
        
        set(figureHandle2, 'Visible', 'on');
    end
end
